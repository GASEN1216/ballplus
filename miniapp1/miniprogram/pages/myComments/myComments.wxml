<view class="page-container">
  <!-- 两栏式选项卡 -->
  <view class="tab-bar">
    <view class="tab {{activeTab === 'post' ? 'active' : ''}}" bindtap="switchTab" data-type="post">
      <text>帖子评论</text>
    </view>
    <view class="tab {{activeTab === 'comment' ? 'active' : ''}}" bindtap="switchTab" data-type="comment">
      <text>评论回复</text>
    </view>
  </view>
  
  <!-- 评论列表 -->
  <scroll-view 
    class="comment-list" 
    scroll-y 
    bindscrolltolower="loadMoreComments" 
    enable-back-to-top>
    
    <!-- 帖子评论 -->
    <block wx:if="{{activeTab === 'post' && postComments.length > 0}}">
      <view class="comment-item" wx:for="{{postComments}}" wx:key="commentId" bindtap="goToPostComment" data-post-id="{{item.postId}}" data-comment-id="{{item.commentId}}">
        <view class="comment-header">
          <text class="target-title">来自帖子: {{item.postTitle || '未知帖子'}}</text>
        </view>
        
        <view class="comment-main">
          <view class="comment-content">{{item.content || '无内容'}}</view>
        </view>
        
        <view class="comment-footer">
          <view class="comment-time">{{item.createTime}}</view>
          <view class="comment-stats">
            <view class="stat-item">
              <image src="/icon/like.png" class="icon"></image>
              <text>{{item.likes || 0}}</text>
            </view>
          </view>
        </view>
      </view>
    </block>
    
    <!-- 评论的回复 -->
    <block wx:if="{{activeTab === 'comment' && commentReplies.length > 0}}">
      <view class="comment-item" wx:for="{{commentReplies}}" wx:key="subCommentId" bindtap="goToCommentDetail" data-comment-id="{{item.commentId}}">
        <view class="comment-header">
          <text class="target-title">回复给: {{item.replyToName || '未知用户'}}</text>
        </view>
        
        <view class="comment-main">
          <view class="comment-content">{{item.content || '无内容'}}</view>
        </view>
        
        <view class="comment-footer">
          <view class="comment-time">{{item.createTime}}</view>
          <view class="comment-stats">
            <view class="stat-item">
              <image src="/icon/like.png" class="icon"></image>
              <text>{{item.likes || 0}}</text>
            </view>
          </view>
        </view>
      </view>
    </block>
    
    <!-- 空状态 -->
    <view class="empty-state" wx:if="{{(activeTab === 'post' && postComments.length === 0 || activeTab === 'comment' && commentReplies.length === 0) && !loading}}">
      <image src="/icon/empty.png" class="empty-icon"></image>
      <text class="empty-text">暂无{{activeTab === 'post' ? '帖子评论' : '评论回复'}}</text>
    </view>
    
    <!-- 加载状态 -->
    <view class="loading-state" wx:if="{{loading}}">
      <view class="loading-spinner"></view>
      <text>加载中...</text>
    </view>
    
    <!-- 加载完成提示 -->
    <view class="load-all" wx:if="{{loadAll && ((activeTab === 'post' && postComments.length > 0) || (activeTab === 'comment' && commentReplies.length > 0))}}">
      <text>已经到底啦</text>
    </view>
  </scroll-view>
</view> 