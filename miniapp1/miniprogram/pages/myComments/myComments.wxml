<view class="page-container">
  <!-- 两栏式选项卡 -->
  <view class="tab-bar">
    <view class="tab {{activeTab === 'post' ? 'active' : ''}}" bindtap="switchTab" data-type="post">
      <text>帖子评论</text>
    </view>
    <view class="tab {{activeTab === 'comment' ? 'active' : ''}}" bindtap="switchTab" data-type="comment">
      <text>评论回复</text>
    </view>
  </view>
  
  <!-- 评论列表 -->
  <scroll-view 
    class="comment-list" 
    scroll-y 
    bindscrolltolower="loadMoreComments" 
    enable-back-to-top>
    
    <!-- 帖子评论 -->
    <block wx:if="{{activeTab === 'post' && postComments.length > 0}}">
      <view class="comment-item" wx:for="{{postComments}}" wx:key="commentId" bindtap="goToPostComment" data-post-id="{{item.postId}}" data-comment-id="{{item.commentId}}">
        <view class="user-avatar">
          <image src="{{item.avatar || '/icon/default-avatar.png'}}" mode="aspectFill"></image>
        </view>
        
        <view class="comment-content">
          <view class="user-info">
            <view class="username">{{item.appName || '匿名用户'}}</view>
            <view class="user-badge" wx:if="{{item.grade}}">UP</view>
          </view>
          
          <view class="comment-text">
            <text>回复了我的帖子: {{item.postTitle || ''}}</text>
          </view>
          
          <view class="reply-content">{{item.content || '无内容'}}</view>
          
          <view class="comment-footer">
            <view class="post-time">{{item.createTime}}</view>
            <view class="action-btns">
              <view class="btn">
                <image src="/icon/comment.png" class="action-icon"></image>
                <text>回复</text>
              </view>
              <view class="btn">
                <image src="/icon/like.png" class="action-icon"></image>
                <text>点赞</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </block>
    
    <!-- 评论的回复 -->
    <block wx:if="{{activeTab === 'comment' && commentReplies.length > 0}}">
      <view class="comment-item" wx:for="{{commentReplies}}" wx:key="subCommentId" bindtap="goToCommentDetail" data-comment-id="{{item.commentId}}">
        <view class="user-avatar">
          <image src="{{item.avatar || '/icon/default-avatar.png'}}" mode="aspectFill"></image>
        </view>
        
        <view class="comment-content">
          <view class="user-info">
            <view class="username">{{item.appName || '匿名用户'}}</view>
            <view class="user-badge" wx:if="{{item.grade}}">UP</view>
          </view>
          
          <view class="comment-text">
            <text>回复了我的评论</text>
          </view>
          
          <view class="reply-content">{{item.content || '无内容'}}</view>
          
          <view class="comment-footer">
            <view class="post-time">{{item.createTime}}</view>
            <view class="action-btns">
              <view class="btn">
                <image src="/icon/comment.png" class="action-icon"></image>
                <text>回复</text>
              </view>
              <view class="btn">
                <image src="/icon/like.png" class="action-icon"></image>
                <text>点赞</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </block>
    
    <!-- 空状态 -->
    <view class="empty-state" wx:if="{{(activeTab === 'post' && postComments.length === 0 || activeTab === 'comment' && commentReplies.length === 0) && !loading}}">
      <image src="/icon/empty.png" class="empty-icon"></image>
      <text class="empty-text">暂无{{activeTab === 'post' ? '帖子评论' : '评论回复'}}</text>
    </view>
    
    <!-- 加载状态 -->
    <view class="loading-state" wx:if="{{loading}}">
      <view class="loading-spinner"></view>
      <text>加载中...</text>
    </view>
    
    <!-- 加载完成提示 -->
    <view class="load-all" wx:if="{{loadAll && ((activeTab === 'post' && postComments.length > 0) || (activeTab === 'comment' && commentReplies.length > 0))}}">
      <text>已经到底啦</text>
    </view>
  </scroll-view>
</view> 