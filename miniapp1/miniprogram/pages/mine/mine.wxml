<view class="container">

  <!-- é¡¶éƒ¨å›ºå®šæ  -->
  <view class="header">
    <view wx:if="{{isLoggedin}}" class="user-info">
      <cover-image src="{{profilePic}}" class="avatar" bindtap="goToInfo"></cover-image>
      <!-- ç”¨æˆ·æ–‡æœ¬ä¿¡æ¯ -->
      <view class="user-text">
        <text class="nickname" bindtap="goToInfo">{{nickname}}</text>
        <view class="level-exp-container">
          <!-- ç­‰çº§ - å°ç‰Œå­ ç»éªŒå€¼-->
          <text class="level-text">LV.{{userData.grade}}</text>
          <text class="exp-text">{{userData.exp}} / {{userData.grade * 10}}</text>
        </view>
        <!-- ç»éªŒ - é•¿æ¡è¿›åº¦æ¡ -->
        <view class="form-item score-item">
          <view class="exp-bar-container">
            <view class="exp-bar">
              <view class="exp-progress" style="width: {{expWidth}};"></view>
            </view>
          </view>
        </view>
      </view>
    </view>
    <view class="settings-btn" bindtap="navigateToSettings">
      <image src="../../icon/settings.png" class="settings-icon" mode="aspectFit"></image>
    </view>
  </view>

    <!-- æ˜¾ç¤ºå‰©ä½™æ—¶é—´ -->
  <view wx:if="{{activities[0].remainingTime}}" class="activity-banner">
    <text class="activity-remaining-time">{{activities[0].remainingTime}}</text>
  </view>

  <!-- æ²¡æœ‰æ´»åŠ¨æ—¶æ˜¾ç¤ºå…¶ä»–æ–‡æ¡ˆ -->
<view wx:else class="activity-banner">
  <text class="activity-remaining-time2">ã€Œæ­¤åˆ» é’å¤©æ— ç‰‡äº‘ã€</text>
</view>

  <!-- æ´»åŠ¨å±•ç¤ºåŒºåŸŸ -->
  <view class="activity-list">
    <!-- åˆ¤æ–­æ˜¯å¦æœ‰æ´»åŠ¨ä¿¡æ¯ -->
    <block wx:if="{{activities.length > 0}}">
      <block wx:for="{{activities}}" wx:key="index">
        <view class="activity-card" bindtap="viewActivityDetail" data-id="{{item.id}}">
          <!-- å¤´åƒ -->
          <cover-image src="{{item.avatar}}" class="activity-avatar"></cover-image>
          <!-- æ´»åŠ¨ä¿¡æ¯ -->
          <view class="activity-details">
            <text class="activity-name">{{item.name}}</text>
            <text class="activity-meta">ğŸ“… {{item.eventDate}} {{item.weekDay}} {{item.eventTime}}-{{item.eventTimee}}</text>
            <text class="activity-meta">ğŸ“ {{item.location}}</text>
            <text class="activity-meta">ğŸ‘¥ {{item.participants}}/{{item.totalParticipants}}</text>
            <text class="activity-remarks">å¤‡æ³¨: {{item.remarks}}</text>
          </view>
          <!-- è·ç¦» -->
          <view class="activity-distance">
            <text>{{item.distance}}</text> <!-- æ˜¾ç¤ºä¸ç”¨æˆ·çš„è·ç¦» -->
          </view>
        </view>
      </block>
    </block>

    <block wx:else>
    <!-- ç©ºçŠ¶æ€å¡ç‰‡ -->
    <view class="activity-card empty-card">
      <text class="poetic-state">ã€Œè‹¥æ— é—²äº‹æŒ‚å¿ƒå¤´ï¼Œä¾¿æ˜¯äººé—´å¥½æ—¶èŠ‚ã€</text>
    </view>
  </block>
  </view>

  <!-- åœ°å›¾å’Œå¥½å‹éƒ¨åˆ† -->
  <view class="navigation-section">
    <view class="nav-item" bindtap="toGdmap">
      <image src="../../icon/location.png" class="nav-icon" mode="aspectFit" />
      <text>åœ°å›¾</text>
    </view>
    <view class="nav-item" bindtap="toFriends">
      <image src="../../icon/mine-icon.png" class="nav-icon" mode="aspectFit" />
      <text>å¥½å‹</text>
    </view>
    <view class="nav-item" bindtap="toPointsMall">
      <image src="../../icon/location.png" class="nav-icon" mode="aspectFit" />
      <text>èµ›ç‚¹å•†åŸ</text>
    </view>
  </view>

  <!-- æ´»åŠ¨éƒ¨åˆ† -->
  <view class="activity-section">
    <text class="activity-title">æ´»åŠ¨</text>
    <view class="activity-items">
      <view class="activity-item" bindtap="goToActivities" data-tab="all">
        <image src="../../icon/activities.png" class="activity-icon"></image>
        <text>æˆ‘çš„æ´»åŠ¨</text>
      </view>
      <view class="activity-item" bindtap="goToActivities" data-tab="0">
        <image src="../../icon/departure.png" class="activity-icon"></image>
        <text>å¾…å‡ºå‘</text>
      </view>
      <view class="activity-item" bindtap="goToActivities" data-tab="1">
        <image src="../../icon/review.png" class="activity-icon"></image>
        <text>å·²å®Œæˆ</text>
      </view>
      <view class="activity-item" bindtap="goToActivities" data-tab="2">
        <image src="../../icon/cancel.png" class="activity-icon"></image>
        <text>å·²å–æ¶ˆ</text>
      </view>
    </view>
  </view>

  <!-- ç™»å½•æŒ‰é’® -->
  <button wx:if="{{!isLoggedin}}" bindtap="onLoginButtonClick">ç™»å½•</button>

  <!-- Token éªŒè¯ -->
  <!-- <view wx:if="{{isLoggedin}}">
    <button class="token-button" bindtap="onTokenButtonClick">éªŒè¯Token</button>
    <text class="token-status">{{tokenStatus}}</text>
  </view> -->

</view>