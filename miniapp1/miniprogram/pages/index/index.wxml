<view class="carousel-container">
  <!-- è½®æ’­å›¾åŒºåŸŸ -->
  <swiper class="carousel" indicator-dots="true" autoplay="true" interval="3000" duration="500">
    <swiper-item wx:for="{{carouselImages}}" wx:key="url" bindtap="onCarouselItemClick" data-index="{{index}}">
      <image src="{{item.url}}" mode="aspectFill" class="carousel-image" />
      <view class="carousel-title" wx:if="{{item.title}}">{{item.title}}</view>
    </swiper-item>
  </swiper>
</view>

<!-- åŠŸèƒ½æŒ‰é’®åŒºåŸŸ -->
<view class="function-section">
  <view class="function-grid">
    <view class="function-item" bindtap="createActivity">
      <image src="/icon/create.png" class="function-icon" mode="aspectFit" />
      <text class="function-text">å‘èµ·æ´»åŠ¨</text>
    </view>
    <view class="function-item" bindtap="matchActivity">
      <image src="/icon/match.png" class="function-icon" mode="aspectFit" />
      <text class="function-text">åŒ¹é…æ´»åŠ¨</text>
    </view>
    <view class="function-item" bindtap="navigateToResources">
      <image src="/icon/resource.png" class="function-icon" mode="aspectFit" />
      <text class="function-text">å­¦ä¹ èµ„æº</text>
    </view>
  </view>
</view>

<!-- æ¬¢è¿åŠ¨ç”» -->
<view class="welcome-animation {{showWelcomeAnimation ? 'show' : ''}}" wx:if="{{showWelcomeAnimation}}">
  <view class="welcome-content">
    <text class="welcome-text">æ¬¢è¿æ¥åˆ°çƒPlusï¼</text>
    <view class="confetti-container">
      <view class="confetti" wx:for="{{20}}" wx:key="*this"></view>
    </view>
  </view>
</view>

<!-- è¿‡åœºåŠ¨ç”» -->
<view class="animation-container" wx:if="{{showAnimation}}">
  <image class="player-one" src="/icon/player1.png"></image>
  <image class="basketball" src="/icon/basketball.png"></image>
  <image class="player-two" src="/icon/player2.png"></image>
</view>

<view class="main-container">
  <view class="filter-container">
    <!-- æ—¥æœŸèŒƒå›´ -->
    <scroll-view class="date-scroll" scroll-x="true">
      <view wx:for="{{dateRange}}" wx:key="index" class="date-item" data-index="{{index}}" bindtap="handleDateSelect">
        <view class="date-number {{selectedDateIndex === index ? 'selected' : ''}}">
          {{item.date}}
        </view>
        <view class="date-week {{selectedDateIndex === index ? 'selected' : ''}}">
          {{item.week}}
        </view>
      </view>
    </scroll-view>

    <!-- ç­›é€‰å’Œæ¨¡å¼åˆ‡æ¢ -->
    <view class="sort-options">
      <view class="sort-dropdown">
        <text bindtap="toggleSortMenu">{{sortOptions[selectedSort]}}</text>
        <text class="dropdown-icon" bindtap="toggleSortMenu">{{isSortMenuOpen ? 'â–²' : 'â–¼'}}</text>
      </view>

      <view class="order-toggle" bindtap="toggleOrder">
        <text>{{order === 'asc' ? 'æ­£åº' : 'å€’åº'}}</text>
        <text class="order-icon">{{order === 'asc' ? 'â–¼' : 'â–²'}}</text>
      </view>
      <view class="map-mode" bindtap="toggleMapMode">
        <text>åœ°å›¾æ¨¡å¼</text>
        <image src="/icon/location.png" class="map-icon" />
      </view>
    </view>
  </view>


  <!-- æ´»åŠ¨å±•ç¤ºåŒºåŸŸ -->
  <view class="activity-list">
    <!-- åˆ¤æ–­æ˜¯å¦æœ‰æ´»åŠ¨ä¿¡æ¯ -->
    <block wx:if="{{filteredActivities.length > 0}}">
      <block wx:for="{{filteredActivities}}" wx:key="index">
        <view class="activity-card" bindtap="viewActivityDetail" data-id="{{item.id}}">
          <!-- å¤´åƒ -->
          <cover-image src="{{item.avatar}}" class="activity-avatar"></cover-image>
          <!-- æ´»åŠ¨ä¿¡æ¯ -->
          <view class="activity-details">
            <text class="activity-name">{{item.name}}</text>
            <text class="activity-meta">ğŸ“… {{item.eventDate}} {{item.weekDay}} {{item.eventTime}}-{{item.eventTimee}}</text>
            <text class="activity-meta">ğŸ“ {{item.location}}</text>
            <text class="activity-meta">ğŸ‘¥ {{item.participants}}/{{item.totalParticipants}}</text>
            <text class="activity-remarks">å¤‡æ³¨: {{item.remarks}}</text>
          </view>
          <!-- è·ç¦» -->
          <view class="activity-distance">
            <text>{{item.distance}}</text> <!-- æ˜¾ç¤ºä¸ç”¨æˆ·çš„è·ç¦» -->
          </view>
        </view>
      </block>
    </block>

    <!-- å½“æ²¡æœ‰æ´»åŠ¨ä¿¡æ¯æ—¶æ˜¾ç¤º -->
    <block wx:else>
      <view class="no-activity">
        <text>æš‚æ—¶æ²¡æœ‰æ´»åŠ¨å‘å¸ƒå“¦~</text>
      </view>
    </block>
  </view>
</view>