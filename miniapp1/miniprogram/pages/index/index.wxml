<view class="carousel-container">
  <!-- 轮播图区域 -->
  <swiper class="carousel" autoplay interval="3000" duration="500" circular>
    <block wx:for="{{carouselImages}}" wx:key="index">
      <swiper-item>
        <image src="{{item.url}}" class="carousel-image" bindtap="onCarouselItemClick" data-link="{{item.link}}" />
      </swiper-item>
    </block>
  </swiper>
</view>

<!-- 发起活动按钮 -->
<view class="create-activity-section">
  <button class="create-activity-button" bindtap="createActivity">➕ 发起活动</button>
</view>

<view class="main-container">
  <view class="filter-container">
    <!-- 日期范围 -->
    <scroll-view class="date-scroll" scroll-x="true">
      <view wx:for="{{dateRange}}" wx:key="index" class="date-item" data-index="{{index}}" bindtap="handleDateSelect">
        <view class="date-number {{selectedDateIndex === index ? 'selected' : ''}}">
          {{item.date}}
        </view>
        <view class="date-week {{selectedDateIndex === index ? 'selected' : ''}}">
          {{item.week}}
        </view>
      </view>
    </scroll-view>

    <!-- 筛选和模式切换 -->
    <view class="sort-options">
      <view class="sort-dropdown">
        <text bindtap="toggleSortMenu">{{sortOptions[selectedSort]}}</text>
        <text class="dropdown-icon" bindtap="toggleSortMenu">{{isSortMenuOpen ? '▲' : '▼'}}</text>
      </view>

      <view class="order-toggle" bindtap="toggleOrder">
        <text>{{order === 'asc' ? '正序' : '倒序'}}</text>
        <text class="order-icon">{{order === 'asc' ? '▼' : '▲'}}</text>
      </view>
      <view class="map-mode" bindtap="toggleMapMode">
        <text>地图模式</text>
        <image src="/icon/location.png" class="map-icon" />
      </view>
    </view>
  </view>


  <!-- 活动展示区域 -->
  <view class="activity-list">
    <!-- 判断是否有活动信息 -->
    <block wx:if="{{filteredActivities.length > 0}}">
      <block wx:for="{{filteredActivities}}" wx:key="index">
        <view class="activity-card" bindtap="viewActivityDetail" data-id="{{item.id}}">
          <!-- 头像 -->
          <cover-image src="{{item.avatar}}" class="activity-avatar"></cover-image>
          <!-- 活动信息 -->
          <view class="activity-details">
            <text class="activity-name">{{item.name}}</text>
            <text class="activity-meta">📅 {{item.eventDate}} {{item.weekDay}} {{item.eventTime}}-{{item.eventTimee}}</text>
            <text class="activity-meta">📍 {{item.location}}</text>
            <text class="activity-meta">👥 {{item.participants}}/{{item.totalParticipants}}</text>
            <text class="activity-remarks">备注: {{item.remarks}}</text>
          </view>
          <!-- 距离 -->
          <view class="activity-distance">
            <text>{{item.distance}}</text> <!-- 显示与用户的距离 -->
          </view>
        </view>
      </block>
    </block>

    <!-- 当没有活动信息时显示 -->
    <block wx:else>
      <view class="no-activity">
        <text>暂时没有活动发布哦~</text>
      </view>
    </block>
  </view>
</view>